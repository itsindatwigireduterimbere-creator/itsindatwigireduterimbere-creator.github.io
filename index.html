<!DOCTYPE html>
<html lang="rw">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SURA URUBUGA RWEMEWE RWA ITD VERIFIED</title>
  <style>
    body { font-family: Poppins, system-ui, sans-serif; background: linear-gradient(120deg,#7b2cbf,#80ed99); color:#fff; padding:20px; }
    .card { background:#fff; color:#111; max-width:980px; margin:0 auto; padding:22px; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,0.12); }
    h1{ margin:0 0 10px; color:#7b2cbf; }
    .input-row{ display:flex; gap:10px; align-items:center; justify-content:center; margin-bottom:14px; }
    input[type="text"]{ padding:10px 12px; border-radius:8px; border:1px solid #ccc; width:260px; font-size:16px; }
    button { padding:10px 18px; border-radius:8px; border:none; cursor:pointer; background:#dfd7e5; color:#fff; font-weight:700; }
    .section-title{ background:#e6ffe9; color:#064; padding:10px 12px; border-radius:8px; margin-top:18px; font-weight:700; }
    .loader { display:none; margin:12px 0; text-align:center; color:#7b2cbf; font-weight:700; }
    .spinner{ border:6px solid #eee; border-top:6px solid #7b2cbf; border-radius:50%; width:44px; height:44px; animation:spin 1s linear infinite; margin:8px auto; }
    @keyframes spin { to { transform:rotate(360deg); } }
    iframe{ width:100%; height:520px; border-radius:10px; border:1px solid #ddd; margin-top:10px; background:#fff; }
    .actions { display:flex; gap:12px; justify-content:center; margin-top:12px; flex-wrap:wrap; }
    input, button {
      width: 40%;
      padding: 10px;
      margin: 8px 0;
      border: 2px solid #ccc;
      border-radius: 8px;
      font-family: Cambria, serif;
    }
     button {
      background: linear-gradient(90deg, var(--purple), var(--green));
      color: white;
      font-weight: bold;
      cursor: pointer;
      border: none;
    }
    body {
      margin: 0;
      font-family: "Cambria", serif;
      background: linear-gradient(180deg, #fbfbfb 0%, var(--bg) 100%);
      color: #222;
    }
     button:hover {
      background: #0a050f9e;
      transform: translateY(-2px);
    }
    #status {
      margin: 15px 0;
      font-weight: 600;
    }
     @keyframes bounce {
      to {
        transform: translateY(-6px);
        opacity: 0.6;
      }
    }
    .btn-link {
      display: inline-block;
      margin: 8px;
      padding: 10px 14px;
      border-radius: 8px;
      background: var(--purple);
      color: rgb(255, 255, 255);
      text-decoration: none;
      font-weight: bold;
    }
    :root {
      --purple: #a000a0;
      --green: #006400;
      --bg: #f9f9f9;
      --card: #ffffff;
      --muted: #666;
    }
    body {
      margin: 0;
      font-family: "Cambria", serif;
      background: linear-gradient(180deg, #fbfbfb 0%, var(--bg) 100%);
      color: #222;
    }
    header, footer {
      text-align: center;
      padding: 16px;
    }
    h1 { color: var(--purple); }
    main {
      max-width: 900px;
      margin: auto;
      padding: 20px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .panel, .card {
      background: var(--card);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border: 2px solid #ccc;
      border-radius: 8px;
      font-family: Cambria, serif;
    }
    button {
      background: linear-gradient(90deg, var(--purple), var(--green));
      color: white;
      font-weight: bold;
      cursor: pointer;
      border: none;
    }
    .btn-link {
      display: inline-block;
      margin: 8px;
      padding: 10px 14px;
      border-radius: 8px;
      background: var(--purple);
      color: rgb(155, 155, 179);
      text-decoration: none;
      font-weight: bold;
    }
    .btn-link {
      display: inline-block;
      margin: 8px;
      padding: 10px 14px;
      border-radius: 8px;
      background: var(--purple);
      color: rgb(255, 255, 255);
      text-decoration: none;
      font-weight: bold;
    }
     button:hover {
      background: #454553;
      transform: translateY(-2px);
    }
    :root {
      --purple: #a000a0;
      --green: #006400;
      --bg: #f9f9f9;
      --card: #ffffff;
      --muted: #666;
    }
  </style>
</head>

<body>
   

    
  <div class="card">
    <h1>TUBAHAYE IKAZE MURI ITD YACU.>>>>ü§ùü§ùü§ùü§ùü§ùü§ùü§ùü§ùü§ù[Itsinda - Twigire - Duterimbere]</h1>
    
 <section class="panel">
      <h2>NIBA URI MUSHYA, NAWE TUGUHAYE IKAZE muri ITD-YACU.
         ITD, ni ikimina gishyigikira abantu bose mu kuzigama no kwiguriza. 
         INTEGO YACU NI UKWIGIRA TUGAKORA IMISHINGA Y'ITERAMBERE.</h2>
      <p>
       TWISHIMIRA ITERAMBERE KURI BOSE. NIYO MPAVU TWATANGIJE Itsinda Twigire Duterimbere, IKIMINA KIDAHEZA.
       üëá
        Ushobora kwizigamira, kwiguriza , kandi nyuma y'umwaka umunyamuryango agabana umugabane we hakurikijwe amategeko ya ITD.
         NAWE TUGUHAYE IKAZE!.
         Dukorera mu murenge wa GAHARA, Mu isantre ya DAGAZA. Niba wifuza Gufunguza konti mu kimina ITD-YACU, iyandikishe.
         Dufite konti z'ibyiciro bibiri: ITD Senior Account( Itangiza umugabane shingiro ikanazigama) na ITD Junior ( Izigama gusa).

      </p>
      <a class="btn-link" href="https://www.notion.so/AMATEGEKO-SHINGIRO-MURI-ITD-298bd1571207805d95dfd9ea644c6d95?source=copy_link" target="_blank">üìò SOMA AMATEGEKO AGENGA ITD</a>
      <a class="btn-link" href="https://www.notion.so/AMABWIRIZA-NGENDERWAHO-MURI-ITD-298bd157120780ebb6aff844a3cbb5a6?source=copy_link" target="_blank">üìò SOMA AMABWIRIZA NGENGAMIKORERE</a>
        
       
      <h3 style="margin-top:20px;">"
        DORE AMWE MU MAKURU USABWA MU KWIYANDIKISHA .......üëáüëáüëáüëá"</h3>
        
      <form id="regForm">
        <input type="text" name="name" placeholder="Amazina yawe" required>
        <input type="email" name="email" placeholder="NOMERO Yiranga muntu" required>
        <input type="tel" name="phone" placeholder="Numero ya telefone" required>
        <input type="text" name="location" placeholder="Aho utuye" required>
      </form>
       <a class="btn-link" href="https://forms.office.com/r/rHT91jDg8e" target="_blank">üìí‚úçÔ∏è IYANDIKISHE</a>
      <a class="btn-link" href="https://meet.google.com/xqj-tsqh-rrd" target="_blank">üè´ INJIRA MU CYUMBA CY'INAMA</a>
      <a class="btn-link" href="https://docs.google.com/spreadsheets/d/1ahbRMBJzJooRbrbruHnmeyGMbPAVHBqTWCcdvxx9NXs/edit?gid=1803820195#gid=1803820195" target="_blank">üë®üèº‚Äçüíªüë®üèº‚Äçüíªüë®üèº‚ÄçüíªüìöGoSDP</a>
       <a class="btn-link" href="https://docs.google.com/spreadsheets/d/1IVzzvAlr6Sb3YDK7wM9K3GdXLkWhKcD2fGj3x4HLYIY/edit?gid=1803820195#gid=1803820195" target="_blank">üë®üèº‚Äçüíª ACCOUNTANTüìöGoSDP</a>
  <a class="btn-link" href="https://www.notion.so/AMATANGAZO-2c1bd15712078002b5f7dd9acb7b8289?source=copy_link" target="_blank">üë®üèº‚ÄçüíªAMATANGAZO</a>
 
      <a class="btn btn-primary" href="https://www.notion.so/IGITABO-CY-INAMA-ITD-2025-29bbd15712078027b51ae342efc82139?source=copy_link" target="_blank" rel="noopener">
            üììIGITABO CY'INAMA
          </a>
    </section>
    
     <p style="color:#333">Munyamuryango, Sura konti yawe ubone amakuru y'ibikorwa byose bikorerwa kuri konti yanyu. <strong>TWIFUZA KO MUBONA RAPORO MUKENEYE, KANDI MUKAZIBONERA KU GIHE. 
      Koresha ID / PIN</strong> Wemeze kuri<strong>INJIRA</strong> --maze ukore ahanditse ngo <strong>REBA IFISHI YAWE</strong>, Urebe raporo muri PDF..</p>
<h1>MURAKAZA NEZA MURI SERIVISE Z'AMARAPORO AGENEWE ABANYAMURYANGO BA IDT </h1>

    <div class="input-row">
      <input id="pin" type="text" placeholder="Injiza ID YAWE. Urug: ID11997xxxxxx" />
      <button id="loginBtn" onclick="onLogin()">INJIRA</button>
    </div>

    <div id="mainLoader" class="loader">
      <div class="spinner"></div>
       Mwihangane mutegereze akanya gato...
    </div>

    <!-- SECTION: Account Balance -->
    <div class="section-title">ITD-SENIOR ACCOUNT BALANCE (Preview)</div>
    <div class="actions">
      <button onclick="loadTab('BALANCE')">REBA IFISHYI YAWE ( ACCOUNT BALANCE)</button>
      <button id="downloadBalanceBtn" onclick="download('BALANCE')" style="display:none;background:#0b7a4d">Download Balance (PDF)</button>
    </div>
    <div id="loaderBalance" class="loader"><div class="spinner"></div> MWIHANGANE ‚Äî TURI GUTEGURA IFISHI YA BALANCE...</div>
    <iframe id="frameBalance" src=""></iframe>

    <!-- SECTION: LPPC -->
    <div class="section-title"> IFISHI YO KWISHYURA INGUZANYO - LPPC (Preview)</div>
    <div class="actions">
      <button onclick="loadTab('LPPC')">REBA IFISHI YO KWISHURA INGUZANYO - Preview LPPC</button>
      <button id="downloadLPPCBtn" onclick="download('LPPC')" style="display:none;background:#0b7a4d">Download LPPC (PDF)</button>
    </div>
    <div id="loaderLPPC" class="loader"><div class="spinner"></div> MWIHANGANE ‚Äî TURI GUTEGURA IFISHI YA LPPC...</div>
    <iframe id="frameLPPC" src=""></iframe>

  </div>

  <script>
    // === Set your deployed Apps Script web app URL here ===
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzp9nLrekIvCi5_0FMRb_sq36TaXYSPegiGarcxitfBTH1nUygWLrYfgAhceIJlo3qk/exec";

    // base64 strings returned from server
    let pdfBalance = null;
    let pdfLPPC = null;

    // Login button: writes PIN to K6 then optionally auto-preview
    async function onLogin() {
      const pin = document.getElementById("pin").value.trim();
      if (!pin) { alert("Shyiramo PIN mbere yo gukomeza."); return; }

      // show global loader briefly while writing PIN
      document.getElementById("mainLoader").style.display = "block";

      try {
        // call server to write PIN (we call with target BALANCE just to write PIN and get response)
        const res = await fetch(SCRIPT_URL, {
          method: "POST",
          body: new URLSearchParams({ pin: pin, target: "BALANCE" })
        });
        const data = await res.json();

        document.getElementById("mainLoader").style.display = "none";

        if (!data.success) {
          alert("Ikibazo: " + (data.error || "Ntibyakunze kwandikisha PIN."));
          return;
        }

        // after successful write we keep returned PDF in pdfBalance and show in iframe
        pdfBalance = "data:application/pdf;base64," + data.file;
        document.getElementById("frameBalance").src = pdfBalance;
        document.getElementById("downloadBalanceBtn").style.display = "inline-block";

        // Optionally we can proactively also fetch LPPC preview (comment/uncomment)
        // await loadTab('LPPC');

        alert("Murakoze. RAPORO YANYU YABONETSE, Emeza OK, maze ukore PREVIEW.");
      } catch (err) {
        document.getElementById("mainLoader").style.display = "none";
        console.error(err);
        alert("Habaye ikibazo mu itumanaho: " + err.message);
      }
    }

    // loadTab: requests PDF for chosen tab (BALANCE or LPPC)
    async function loadTab(tabName) {
      const pin = document.getElementById("pin").value.trim();
      if (!pin) { alert("Shyiramo PIN mbere yo gukomeza."); return; }

      const loaderId = tabName === 'BALANCE' ? 'loaderBalance' : 'loaderLPPC';
      const frameId = tabName === 'BALANCE' ? 'frameBalance' : 'frameLPPC';
      const downloadBtnId = tabName === 'BALANCE' ? 'downloadBalanceBtn' : 'downloadLPPCBtn';

      document.getElementById(loaderId).style.display = "block";
      document.getElementById(frameId).src = "";
      document.getElementById(downloadBtnId).style.display = "none";

      try {
        const res = await fetch(SCRIPT_URL, {
          method: "POST",
          body: new URLSearchParams({ pin: pin, target: tabName })
        });
        const data = await res.json();
        document.getElementById(loaderId).style.display = "none";

        if (!data.success) {
          alert("Ntibyakunze: " + (data.error || "Error"));
          return;
        }

        const pdfData = "data:application/pdf;base64," + data.file;
        if (tabName === 'BALANCE') {
          pdfBalance = pdfData;
          document.getElementById('frameBalance').src = pdfBalance;
          document.getElementById('downloadBalanceBtn').style.display = 'inline-block';
        } else {
          pdfLPPC = pdfData;
          document.getElementById('frameLPPC').src = pdfLPPC;
          document.getElementById('downloadLPPCBtn').style.display = 'inline-block';
        }

      } catch (err) {
        document.getElementById(loaderId).style.display = "none";
        console.error(err);
        alert("Habaye ikosa mu gutumanaho: " + err.message);
      }
    }

    // download function
    function download(which) {
      const pdf = which === 'BALANCE' ? pdfBalance : pdfLPPC;
      if (!pdf) return alert("Nta PDF yabonetse kugirango ukuremo.");
      const a = document.createElement("a");
      a.href = pdf;
      a.download = which + "_ITD_SENIOR.pdf";
      a.click();
    }

  </script>
</body>
</html>
